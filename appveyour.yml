version: '{build}'
install:
  - ps: |
      If ($env:Platform -Match "x86") {
        $env:PCRE_PLATFORM="Win32"
        $env:JAVA_HOME="c:/Program Files (x86)/Java/jdk1.8.0"
        $env:MSBuildDir="C:/Program Files (x86)/MSBuild/14.0/Bin/msbuild.exe"
        $env:VCVARS_PLATFORM="x86"
        $env:LANG_PLATFORM=""
      } Else {
        $env:PCRE_PLATFORM="x64"
        $env:JAVA_HOME="c:/Program Files/Java/jdk1.8.0"
        $env:MSBuildDir="C:/Program Files/MSBuild/14.0/Bin/msbuild.exe"
        $env:VCVARS_PLATFORM="amd64"
        $env:LANG_PLATFORM="-x64"
      }	  
build_script:
  - build.bat
  - nuget pack VSSonarExtensionPlugin3Api.nuspec
  - nuget pack VSSonarExtensionPlugin4Api.nuspec
artifacts:
  - path: 'BuildDrop\vs12\VSSonarExtensionMetroVs2012.vsix'
    name: VSSonarExtensionMetroVs2012
  - path: 'BuildDrop\vs13\VSSonarExtensionMetroVs2013.vsix'
    name: VSSonarExtensionMetroVs2013
  - path: 'BuildDrop\vs15\VSSonarExtensionMetroVs2015.vsix'
    name: VSSonarExtensionMetroVs2015
  - path: 'BuildDrop\vs15\VSSonarExtensionPlugin3Api.nupkg'
    name: VSSonarExtensionPlugin3Api
  - path: 'BuildDrop\vs15\VSSonarExtensionPlugin4Api.nupkg'
    name: VSSonarExtensionPlugin4Api    